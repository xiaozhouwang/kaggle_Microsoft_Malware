import pandas as pd
import sys
import numpy as np
def multiclass_log_loss(y_true, y_pred, eps=1e-15):
    """Multi class version of Logarithmic Loss metric.
    https://www.kaggle.com/wiki/MultiClassLogLoss

    Parameters
    ----------
    y_true : array, shape = [n_samples]
            true class, intergers in [0, n_classes - 1)
    y_pred : array, shape = [n_samples, n_classes]

    Returns
    -------
    loss : float
    """
    predictions = np.clip(y_pred, eps, 1 - eps)

    # normalize row sums to 1
    predictions /= predictions.sum(axis=1)[:, np.newaxis]

    actual = np.zeros(y_pred.shape)
    n_samples = actual.shape[0]
    actual[np.arange(n_samples), y_true.astype(int)] = 1
    vectsum = np.sum(actual * np.log(predictions))
    loss = -1.0 / n_samples * vectsum
    return loss
s1=pd.read_csv('sampleSubmission.csv',index_col=0)
s2=pd.read_csv(sys.argv[1],index_col=0)
name=s1.columns.values
ytrue=np.argmax(np.array(s1[name]),axis=1)
ypred=np.array(s2[name])
print 'loss',multiclass_log_loss(ytrue, ypred)

